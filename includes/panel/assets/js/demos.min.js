(function(e){"use strict";e(document).ready(function(){window.owpDemoImport.init()}),window.owpDemoImport={importData:{},allowPopupClosing:!0,init:function(){var t=this;e(".owp-search-input").on("keyup",function(){0<e(this).val().length?(e(".owp-demo-wrap .themes").find(".theme-wrap").hide(),e(".owp-demo-wrap .themes").find('.theme-wrap[data-name*="'+e(this).val().toLowerCase()+'"]').show()):e(".owp-demo-wrap .themes").find(".theme-wrap").show()}),e(".owp-demo-wrap .theme-actions a.button").on("click",function(e){e.stopPropagation()}),e(".owp-open-popup").click(function(o){if(!e(o.target).hasClass("owp-live-preview")){o.preventDefault();var a=e(this).data("demo-id"),i=e(this).data("demo-type"),n=e(".preview-"+a),s=e(".preview-all-"+a);n.show(),s.show(),t.getDemoData(a,i)}}),e(document).on("click",".install-now",this.installNow),e(document).on("click",".activate-now",this.activatePlugins),e(document).on("wp-plugin-install-success",this.installSuccess),e(document).on("wp-plugin-installing",this.pluginInstalling),e(document).on("wp-plugin-install-error",this.installError),e(".owp-elementor-link").on("click",function(t){t.preventDefault(),e(this).parent().addClass("active"),e(".owp-gutenberg-link").parent().removeClass("active"),e(".owp-navigation .elementor-demos").show(),e(".owp-navigation .gutenberg-demos").hide(),e(".owp-demo-wrap .themes.elementor-items").show(),e(".owp-demo-wrap .themes.gutenberg-items").hide()}),e(".owp-gutenberg-link").on("click",function(t){t.preventDefault(),e(this).parent().addClass("active"),e(".owp-elementor-link").parent().removeClass("active"),e(".owp-navigation .gutenberg-demos").show(),e(".owp-navigation .elementor-demos").hide(),e(".owp-demo-wrap .themes.gutenberg-items").show(),e(".owp-demo-wrap .themes.elementor-items").hide()}),this.categoriesFilter(".elementor-items",".elementor-demos"),this.categoriesFilter(".gutenberg-items",".gutenberg-demos")},categoriesFilter:function(t,o){var a=e(".owp-demo-wrap .themes"+t).find(".theme-wrap"),i="owp-is-fadeout",n="owp-is-fadein",s=200,p=function(){var t=e.Deferred();return a.addClass(i),setTimeout(function(){a.removeClass(i).hide(),t.resolve()},s),t.promise()},r=function(e,t){var o=e?'[data-categories*="'+e+'"]':"div";"all"===e&&(o="div"),a.filter(o).show().addClass("owp-is-fadein"),setTimeout(function(){a.removeClass(n),t.resolve()},s)},l=function(t){var o=e.Deferred(),a=p();return a.done(function(){r(t,o)}),o};e(o+" .owp-navigation-link").on("click",function(o){o.preventDefault(),e(this).parent().siblings().removeClass("active"),e(this).parent().addClass("active");var a=this.hash.slice(1),i=e(".owp-demo-wrap .themes"+t);i.css("min-width",i.outerHeight());var n=l(a);n.done(function(){i.removeAttr("style")})})},getDemoData:function(t,o){var a=this;e.ajax({url:owpDemos.ajaxurl,type:"get",data:{action:"owp_ajax_get_import_data",demo_name:t,demo_type:o,security:owpDemos.owp_import_data_nonce},complete:function(t){a.importData=e.parseJSON(t.responseText)}}),e.ajax({url:owpDemos.ajaxurl,type:"get",data:{action:"owp_ajax_get_demo_data",demo_name:t,demo_type:o,demo_data_nonce:owpDemos.demo_data_nonce},complete:function(o){a.runPopup(o);var i=e(".preview-"+t),n=e(".preview-all-"+t);i.hide(),n.hide()}})},runPopup:function(t){var o=this,a=e("html").innerWidth();e("html").css("overflow","hidden");var i=e("html").innerWidth();e("html").css("margin-right",i-a),e("#owp-demo-popup-wrap").fadeIn(),e(t.responseText).appendTo(e("#owp-demo-popup-content")),e(".owp-demo-popup-close, .owp-demo-popup-overlay").on("click",function(e){e.preventDefault(),!0===o.allowPopupClosing&&o.closePopup()}),e(".owp-plugins-next").on("click",function(t){t.preventDefault(),e("#owp-demo-plugins").hide(),e("#owp-demo-import-form").show()}),e("#owp-demo-import-form").submit(function(t){t.preventDefault();var a=e(this).find('[name="owp_import_demo"]').val(),i=e(this).find('[name="owp_import_demo"]').data("demo-type"),n=e(this).find('[name="owp_import_demo_data_nonce"]').val(),s=[];e(this).find('input[type="checkbox"]').each(function(){!0===e(this).is(":checked")&&s.push(e(this).attr("name"))}),e(this).hide(),e(".owp-loader").show(),o.importContent({demo:a,demoType:i,nonce:n,contentToImport:s,isXML:e("#owp_import_xml").is(":checked")})})},importContent:function(t){var o,a,i=this,n=(Date.now(),{owp_import_demo:t.demo,owp_import_demo_type:t.demoType,owp_import_demo_data_nonce:t.nonce});if(this.allowPopupClosing=!1,e(".owp-demo-popup-close").fadeOut(),0===t.contentToImport.length)return setTimeout(function(){e(".owp-loader").hide(),e(".owp-last").show()},1e3),e.ajax({url:owpDemos.ajaxurl,type:"post",data:{action:"owp_after_import",owp_import_demo:t.demo,owp_import_demo_type:t.demoType,owp_import_demo_data_nonce:t.nonce,owp_import_is_xml:t.isXML},complete:function(e){}}),this.allowPopupClosing=!0,void e(".owp-demo-popup-close").fadeIn();for(var s in this.importData){var p=e.inArray(this.importData[s].input_name,t.contentToImport);if(-1!==p){o=s,t.contentToImport.splice(p,1),n.action=this.importData[s].action;break}}e(".owp-import-status").append('<p class="owp-importing">'+this.importData[o].loader+"</p>");var r=e.ajax({url:owpDemos.ajaxurl,type:"post",data:n,complete:function(o){clearTimeout(a);var n=!0;if(500===o.status||502===o.status||503===o.status)e(".owp-importing").addClass("owp-importing-failed").removeClass("owp-importing").text(owpDemos.content_importing_error+" "+o.status);else if(-1!==o.responseText.indexOf("successful import"))e(".owp-importing").addClass("owp-imported").removeClass("owp-importing");else{var s=e.parseJSON(o.responseText),p="";for(var r in s)p+=s[r],"xml_import_error"===r&&(n=!1);e(".owp-importing").addClass("owp-importing-failed").removeClass("owp-importing").text(p),i.allowPopupClosing=!0,e(".owp-demo-popup-close").fadeIn()}!0===n&&i.importContent(t)}});a=setTimeout(function(){r.abort(),i.allowPopupClosing=!0,e(".owp-demo-popup-close").fadeIn(),e(".owp-importing").addClass("owp-importing-failed").removeClass("owp-importing").text(owpDemos.content_importing_error)},9e5)},closePopup:function(){e("html").css({overflow:"","margin-right":""}),e(".preview-icon").hide(),e(".preview-all").hide(),e("#owp-demo-popup-wrap").fadeOut(),setTimeout(function(){e("#owp-demo-popup-content").html("")},600)},installNow:function(t){t.preventDefault();var o=e(t.target),a=e(document);o.hasClass("updating-message")||o.hasClass("button-disabled")||(wp.updates.shouldRequestFilesystemCredentials&&!wp.updates.ajaxLocked&&(wp.updates.requestFilesystemCredentials(t),a.on("credential-modal-cancel",function(){var t=e(".install-now.updating-message");t.removeClass("updating-message").text(wp.updates.l10n.installNow),wp.a11y.speak(wp.updates.l10n.updateCancel,"polite")})),wp.updates.installPlugin({slug:o.data("slug")}))},activatePlugins:function(t){t.preventDefault();var o=e(t.target),a=o.data("init");o.data("slug");o.hasClass("updating-message")||o.hasClass("button-disabled")||(o.addClass("updating-message button-primary").html(owpDemos.button_activating),e.ajax({url:owpDemos.ajaxurl,type:"POST",data:{action:"owp_ajax_required_plugins_activate",init:a}}).done(function(e){e.success&&o.removeClass("button-primary install-now activate-now updating-message").attr("disabled","disabled").addClass("disabled").text(owpDemos.button_active)}))},installSuccess:function(t,o){t.preventDefault();var a=e(".owp-plugin-"+o.slug).find(".button"),i=a.data("init");a.removeClass("install-now installed button-disabled updated-message").addClass("updating-message").html(owpDemos.button_activating),setTimeout(function(){e.ajax({url:owpDemos.ajaxurl,type:"POST",data:{action:"owp_ajax_required_plugins_activate",init:i}}).done(function(e){e.success?a.removeClass("button-primary install-now activate-now updating-message").attr("disabled","disabled").addClass("disabled").text(owpDemos.button_active):a.removeClass("updating-message")})},1200)},pluginInstalling:function(t,o){t.preventDefault();var a=e(".owp-plugin-"+o.slug),i=a.find(".button");i.addClass("updating-message")},installError:function(t,o){t.preventDefault();var a=e(".owp-plugin-"+o.slug);a.removeClass("button-primary").addClass("disabled").html(wp.updates.l10n.installFailedShort)}}})(jQuery);